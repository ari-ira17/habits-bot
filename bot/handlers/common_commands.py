from aiogram import Router, F, types
from aiogram.filters import Command
from aiogram.types import Message
from aiogram.types import ReplyKeyboardRemove

from keyboards.reply_keyboards.done_habit_kb import get_on_start_kb
from keyboards.reply_keyboards.done_habit_kb import ButtonText
from habit.data import user_habits

router = Router()

@router.message(Command("start"))
async def cmd_start(message: Message):
    await message.answer(
        text = f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é –í–∞—Å, {message.from_user.full_name}!\n\n"
                f"–Ø - <b>HabitsBot</b>, –ø–æ–º–æ–≥–∞—é—â–∏–π —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏üòå\n\n"
                f"–° –º–æ–µ–π –ø–æ–º–æ—â—å—é –í—ã –º–æ–∂–µ—Ç–µ <b>—Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</b>, –æ –∫–æ—Ç–æ—Ä–æ–π —è –±—É–¥—É <b>–Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å</b> –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, "
                f"–∞ —Ç–∞–∫–∂–µ –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –í—ã –Ω–∞—á–Ω–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å <b>–æ—Ç—á–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π</b> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–∏ü§ù\n\n"
                f"–í–æ—Ç –º–æ–∏ <b>–∫–æ–º–∞–Ω–¥—ã</b>:\n"
                f"- /help - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞, —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)\n"
                f"- /show_my_habits - –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –í–∞—à–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏\n"
                f"- /add_habit - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø—Ä–∏–≤—ã—á–∫–∏\n\n"
                f"–ù–∞—á–Ω–µ–º?ü¶æ",
        reply_markup=get_on_start_kb(),
    )

@router.message(F.text == ButtonText.NO)
async def stop_bot(message: types.Message):
    await message.answer(
        text = f"–í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É. "
                f"–Ø –≤—Å–µ–≥–¥–∞ –∑–¥–µ—Å—å —á—Ç–æ–±—ã –ø–æ–º–æ—á—å!\n\n"
                f"–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–∑–∂–µ, –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /add_habitüòä",
                reply_markup=ReplyKeyboardRemove()) 
    
@router.message(Command("help"))
async def cmd_help(message: Message):
    await message.answer(
        text = f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é –í–∞—Å, {message.from_user.full_name}!\n\n"
                f"–Ø - <b>HabitsBot</b>, –ø–æ–º–æ–≥–∞—é—â–∏–π —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏üòå\n\n"

                f"–° –º–æ–µ–π –ø–æ–º–æ—â—å—é –í—ã –º–æ–∂–µ—Ç–µ <b>—Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</b>, –æ –∫–æ—Ç–æ—Ä–æ–π —è –±—É–¥—É <b>–Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å</b> –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, "
                f"–∞ —Ç–∞–∫–∂–µ –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –í—ã –Ω–∞—á–Ω–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å <b>–æ—Ç—á–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π</b> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–∏ü§ù\n\n"

                f"–í–æ—Ç –º–æ–∏ <b>–∫–æ–º–∞–Ω–¥—ã</b>:\n"
                f"- /help - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞, —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)\n"
                f"- /show_my_habits - –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –í–∞—à–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏\n"
                f"- /add_habit - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø—Ä–∏–≤—ã—á–∫–∏\n\n"

                f"–ü—Ä–æ—Ü–µ—Å—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ <b>–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏</b> –ø—Ä–∏–≤—ã—á–∫–∏, " 
                f"—á–µ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –µ–µ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ. "
                f"–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É —Å —Ä–∞–∑–Ω—ã–º —Ç–∏–ø–æ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è:\n\n"

                f"üìö  –ü—Ä–∏–≤—ã—á–∫–∞ <b>–ß—Ç–µ–Ω–∏–µ</b> —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –∫–∞–∂–¥—ã–µ 2 –¥–Ω—è –≤ 20:00\n"
                f"üßπ  –ü—Ä–∏–≤—ã—á–∫–∞ <b>–£–±–æ—Ä–∫–∞</b> —Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –ø–æ –≤—Ç–æ—Ä–Ω–∏–∫–∞–º –∫–∞–∂–¥—ã–µ –¥–≤–µ –Ω–µ–¥–µ–ª–∏ –≤ 10:00\n\n"

                f"–ö–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤—Ä–µ–º—è <b>–Ω–∞–ø–æ–º–Ω–∏—Ç—å –æ –∑–∞–¥–∞—á–µ</b>, —è –ø—Ä–∏—Å—ã–ª–∞—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, " 
                f"–∞ –í–∞–º –Ω—É–∂–Ω–æ <b>–æ—Ç–≤–µ—Ç–∏—Ç—å</b>, –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –ª–∏ –í—ã –µ–µ‚úÖ\n\n"

                f"–í —Å–ª—É—á–∞–µ <b>–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞</b> –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ <b>–æ–±–Ω—É–ª—è–µ—Ç—Å—è</b>, "
                f"–∏ —è –ø—Ä–∏—à–ª—é <b>—Å–æ–≤–µ—Ç</b> –ø–æ –µ–µ —É—Å–ø–µ—à–Ω–æ–º—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—éü´Ç\n\n"

                f"–¢–∞–∫–∂–µ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ <b>–æ—Ç—á–µ—Ç</b>, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç –í–∞–º, "
                f"–Ω–∞—Å–∫–æ–ª—å–∫–æ –í—ã <b>–±–ª–∏–∑–∫–∏</b> –∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–∏ " 
                f"—Å –ø–æ–º–æ—â—å—é –¥–µ—Ç–∞–ª—å–Ω–æ–π <b>—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</b> –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞!‚ú®\n\n"

                f"P.S. –ü–æ –≤—Å–µ–º –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–º –≤–æ–ø—Ä–æ—Å–∞–º –º–æ–∂–µ—Ç–µ <b>–æ–±—Ä–∞—Ç–∏—Ç—å—Å—è</b> –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É - @ari_ira17üë©‚Äçüíª",
        reply_markup=ReplyKeyboardRemove()
    )

@router.message(Command("show_my_habits"))
async def cmd_show_my_habits(message: Message):
    user_id = message.from_user.id
    
    if user_id not in user_habits or not user_habits[user_id]:
        await message.answer(
            text = f"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫.",
            reply_markup=ReplyKeyboardRemove())
        return
    
    habits = user_habits[user_id]
    text = f"üìã –í–∞—à–∏ –ø—Ä–∏–≤—ã—á–∫–∏ ({len(habits)}):\n\n"
    f"–ù–∞–∑–≤–∞–Ω–∏–µ, –∏–Ω–µ—Ç–µ—Ä–≤–∞–ª –ø–æ–≤—Ç–æ—Ä–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–∑ –ë–î"
    
    await message.answer(text)
